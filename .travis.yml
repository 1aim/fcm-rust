sudo: false
language: rust
rust:
- stable
- nightly

before_script:
- |
  pip install 'travis-cargo<0.2' --user &&
  export PATH=$HOME/.local/bin:$PATH

script:
- |
  travis-cargo build &&
  travis-cargo test &&
  travis-cargo bench &&
  travis-cargo --only nightly doc

after_success:
  - travis-cargo --only nightly doc-upload
  - travis-cargo coveralls --no-sudo

addons:
  apt:
    packages:
      # Required for kcov
      - libcurl4-openssl-dev
      - libelf-dev
      - libdw-dev

env:
  global:
  # override the default `--features unstable` used for the nightly branch (optional)
  - TRAVIS_CARGO_NIGHTLY_FEATURE=""
  - secure: "gDbw39mo88DcDhqQocaJ4Yxs8x7nYzKE+uLE7I4ZYgtBt5j4a8vo2fsr5U3DwKRHplihiuUStAYqO2Qv1nBzhkAmdzSz1n1ljqdmIG+hZ9FwAITXcqrGSDcPGcFjhZn0TFC7PAufH/0jssatq4XgQBiFbiacPfWXq2xwUd6iaQArLNPXGfYXQytz6x31xdofJbJnffoUjgRN6DE1cUXt4n1Dmdq2gP1t61hqEXeBu0JwArrBm2V5IDXO4R+qhSkCsDwkhRC6w/pZ+C+HhH1wV/2EQuLXQ2Hrk3WpiWQ2jz/z7U3shWD0CWQ08rn9y5Hb0bmIhzo1Wvt4oiOmX2ERk5/UgqjGVsCMNboOKdtZzLKDX3dRn5amVK2KPZj9Ews+rZJDjFTsomobOLmK9fx9He68HS9ARVJAg0TXaQ8iWJfgCAMPK06QtAX3WfROPI4yN/QBi4WJIL6+2JhqjK/LU1BoDqEOAgrH+sAI2wcDJ3E1Uxr6SeF9FFzSPvf7Ga4lPXuv/P6qkHQ4xBn/eAz/MCUfP9UJzdSCPCDJfdQbvx1m2hrV+Lg/hIjegQtTADIf/wm5zyTYkW4egdrh/TSSkxYWCuLhh0+hRdJuNiVm8eGEhV3L1by3rb3qoaD9fcn1rL/ac2QHNT+JC+fG3+GmCN+JMa+K1U1U4XreY1CNArs="
  - secure: nP55f9O2fj7YPvRmu2bRl0Q6f6wXqZPMJbD1NBzHeBMRIz6+fcg/K96TnPIgys5kLBItJ93RtIDDy0IPJfIBpvDnOe6T262CKus9HgKJdwvkggcUGgpZ8InagiKqhvcq8n/vLjAooQs2hRTbUFGceFgx1kdgUP1wlhMQW8mYtg/KLL7/K2FQse7Yk31Co1ZKeW/ni4mLNVcKNA4mOtXINvsTl8LyXdMlwBRLczP/sJbBE5XRGAsVnvIJ8HS/A2DSGld4xwGJXHTNCfpu/tErcYu72gjGjoihaon1M5WvJHFkuzWuY2fs9aZ+jQ0TlCs0175ZL8D4F439htj7ByDeTRlEzZS30VZTB2UMnSxnx5EwVOeU/MB/5yE6kMMpnGmU5ILVRetVNqopODK8F0kOhkjVc2G5C1H2G14D7LaoWnMEjxOHgp5beswsCo4JbpsuEOSyz3oxqAZiKp6IJoVGnYJYR08fax2DSQLvYwen9ENFB+xEq/Gk3dYboLvNyrzX/oCraA7Y4iucd83YTxOhbSwP3r2IbgT39K+UfEAoqpbmDWpzfpliw2t36ETZax38FJ6Pnn+0gLwVcvTahY2klg+IUkkcojjZnigpUFFL3kkcjSk58cDjpwI/qX3ycfzbsvzD67G8c1U4xMDGLN+3mfwFsxQb0xrCjEP560v7JN4=

notifications:
  email:
    on_success: change
    on_failure: always
    on_start: false
